{
  /* Visit https://firebase.google.com/docs/database/security to learn more about security rules. */
  "rules": {
    ".read": "auth != null",
    ".write": "auth != null && root.child('users').child(auth.uid).child('role').val() === 'admin'",
    
    "users": {
      "$uid": {
        ".read": "auth != null && (auth.uid === $uid || root.child('users').child(auth.uid).child('role').val() === 'admin')",
        ".write": "auth != null && auth.uid === $uid"
      }
    },
    
    "organizations": {
      "$orgId": {
        ".read": "auth != null && root.child('organizations').child($orgId).child('members').child(auth.uid).exists()",
        ".write": "auth != null && root.child('organizations').child($orgId).child('ownerId').val() === auth.uid"
      }
    },
    
    "coaches": {
      "$coachId": {
        ".read": "auth != null",
        ".write": "auth != null && (root.child('users').child(auth.uid).child('role').val() === 'admin' || auth.uid === $coachId)"
      }
    },
    
    "clients": {
      "$clientId": {
        ".read": "auth != null && (root.child('users').child(auth.uid).child('role').val() === 'admin' || root.child('coaches').child(auth.uid).child('clients').child($clientId).exists() || auth.uid === $clientId)",
        ".write": "auth != null && (root.child('users').child(auth.uid).child('role').val() === 'admin' || root.child('coaches').child(auth.uid).child('clients').child($clientId).exists())"
      }
    },
    
    "checkIns": {
      "$checkInId": {
        ".read": "auth != null && (root.child('users').child(auth.uid).child('role').val() === 'admin' || root.child('checkIns').child($checkInId).child('coachId').val() === auth.uid || root.child('checkIns').child($checkInId).child('clientId').val() === auth.uid)",
        ".write": "auth != null && (root.child('users').child(auth.uid).child('role').val() === 'admin' || root.child('checkIns').child($checkInId).child('coachId').val() === auth.uid || root.child('checkIns').child($checkInId).child('clientId').val() === auth.uid)"
      }
    },
    
    "metrics": {
      ".read": "auth != null",
      ".write": "auth != null && root.child('users').child(auth.uid).child('role').val() === 'admin'"
    },
    
    "analytics": {
      ".read": "auth != null",
      ".write": "auth != null && root.child('users').child(auth.uid).child('role').val() === 'admin'"
    }
  }
}